Imports System.Data
Imports System.Data.SqlClient
Imports System.Net
Imports System.Net.Mail

Public Class correocompras

    Public Function evaluacionproveedor(ByVal folio As Integer) As String
        Dim sqlbr As New StringBuilder

        Dim myConnection As New SqlConnection((New Conexion).StrConexion)
        'Dim destinos = "vosornog@gmail.com"
        Dim destinos = "vicenteo@grupobatia.com.mx;"

        Dim sql As String = ""

        sql = "select a.id_evaluacionproveedor, d.nombre as nombre, convert(varchar(12), a.fecha_evaluacion, 103) as fecha_evaluacion, b.descripcion as descripcionstatus,"
        sql += "promedio, texto_promedio "
        sql += " from tb_evaluacionproveedor a inner join tb_statusep b on a.id_status = b.id_status "
        sql += " inner join tb_proveedor d on a.id_proveedor = d.id_proveedor "
        sql += " inner join personal c on a.id_usuario = c.idpersonal "
        sql += " where id_evaluacionproveedor = " & folio & ";"
        Dim da As New SqlDataAdapter(sql, myConnection)
        Dim dt As New DataSet
        da.Fill(dt)
        'If dt.Tables(0).Rows.Count > 0 Then
        '    destinos += dt.Tables(0).Rows(0)("correos")
        'End If
        sqlbr.Append("<html style=""width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<head>" & vbCrLf)
        sqlbr.Append("<meta charset=""UTF-8"">" & vbCrLf)
        sqlbr.Append("<meta content=""width=device-width, initial-scale=1"" name=""viewport"">" & vbCrLf)
        sqlbr.Append("<meta name=""x-apple-disable-message-reformatting"">" & vbCrLf)
        sqlbr.Append("<meta http-equiv=""X-UA-Compatible"" content=""IE=edge"">" & vbCrLf)
        sqlbr.Append("<meta content=""telephone=no"" name=""format-detection"">" & vbCrLf)
        sqlbr.Append("<title>Nuevo correo electrónico 2</title>" & vbCrLf)
        sqlbr.Append("<!--[if (mso 16)]>" & vbCrLf)
        sqlbr.Append("<style type=""text/css"">" & vbCrLf)
        sqlbr.Append("a {text-decoration: none;}" & vbCrLf)
        sqlbr.Append("</style>" & vbCrLf)
        sqlbr.Append("<![endif]-->" & vbCrLf)
        sqlbr.Append("<!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]-->" & vbCrLf)
        sqlbr.Append("<!--[if !mso]><!-- -->" & vbCrLf)
        sqlbr.Append("<link href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,700,700i"" rel=""stylesheet"">" & vbCrLf)
        sqlbr.Append("<!--<![endif]-->" & vbCrLf)
        sqlbr.Append("<style type=""text/css"">" & vbCrLf)
        sqlbr.Append("@media only screen and (max-width:600px) {p, ul li, ol li, a { font-size:16px!important; line-height:150%!important } h1 { font-size:30px!important; text-align:center; line-height:120%!important } h2 { font-size:26px!important; text-align:center; line-hei" & vbCrLf)
        sqlbr.Append("#outlook a {" & vbCrLf)
        sqlbr.Append("	padding: 0;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".ExternalClass {" & vbCrLf)
        sqlbr.Append("	width: 100%;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".ExternalClass," & vbCrLf)
        sqlbr.Append(".ExternalClass p," & vbCrLf)
        sqlbr.Append(".ExternalClass span," & vbCrLf)
        sqlbr.Append(".ExternalClass font," & vbCrLf)
        sqlbr.Append(".ExternalClass td," & vbCrLf)
        sqlbr.Append(".ExternalClass div {" & vbCrLf)
        sqlbr.Append("	line-height:  100%;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".es-button {" & vbCrLf)
        sqlbr.Append("	mso-style-priority:100!important;" & vbCrLf)
        sqlbr.Append("	text-decoration: none!important;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append("a[x-apple-data-detectors] {" & vbCrLf)
        sqlbr.Append("	color:inherit!important;" & vbCrLf)
        sqlbr.Append("	text-decoration: none!important;" & vbCrLf)
        sqlbr.Append("	font-size:inherit!important;" & vbCrLf)
        sqlbr.Append("	font-family: inherit!important;" & vbCrLf)
        sqlbr.Append("	font-weight:inherit!important;" & vbCrLf)
        sqlbr.Append("	line-height: inherit!important;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".es-desk-hidden {" & vbCrLf)
        sqlbr.Append("	display:none;" & vbCrLf)
        sqlbr.Append("	float: Left;" & vbCrLf)
        sqlbr.Append("	overflow:hidden;" & vbCrLf)
        sqlbr.Append("	width:  0;" & vbCrLf)
        sqlbr.Append("	max-height:0;" & vbCrLf)
        sqlbr.Append("	line-height:  0;" & vbCrLf)
        sqlbr.Append("	mso-hide: all;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append("</style>" & vbCrLf)
        sqlbr.Append("</head>" & vbCrLf)
        sqlbr.Append("<body style=""width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<div class=""es-wrapper-color"" style=""background-color:#E4E5E7;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-header"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-header-body"" width=""600"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#34265F;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;padding-top:20px;padding-left:20px;padding-right:20px;"">" & vbCrLf)
        sqlbr.Append("<!--[if mso]><table width=""560"" cellpadding=""0"" cellspacing=""0""><tr><td width=""178"" valign=""top""><![endif]-->" & vbCrLf)
        sqlbr.Append("<table class=""es-left"" cellspacing=""0"" cellpadding=""0"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p0r es-m-p20b"" width=""178"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-txt-c"" align=""left"" style=""padding:0;Margin:0;""><img src=""http://grupobatia.com.mx/images/gbblanco.png"" alt=""Logo Batia"" title=""Logo Batia"" width=""104"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<!--[if mso]></td><td width=""20""></td><td width=""362"" valign=""top""><![endif]-->" & vbCrLf)
        sqlbr.Append("<table cellspacing=""0"" cellpadding=""0"" align=""right"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""362"" align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-txt-c"" align=""right"" style=""padding:0;Margin:0;padding-top:15px;padding-bottom:20px;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;"">Fecha:  " & dt.Tables(0).Rows(0)("fecha_evaluacion") & "</p><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;"" id=""txfecha""></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<!--[if mso]></td></tr></table><![endif]--></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img class=""adapt-img"" src=""http://grupobatia.com.mx/images/47051523540803179.png"" alt style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" width=""600""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-content"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-content-body"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EDEDED;"" width=""600"" cellspacing=""0"" cellpadding=""0"" bgcolor=""#ededed"" align=""center"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-top:20px;padding-left:40px;padding-right:40px;""><h1 style=""Margin:0;line-height:36px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:30px;font-style:normal;font-weight:normal;color:#333333;"">Mensaje generado por SINGA</h1></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img class=""adapt-img"" src=""http://grupobatia.com.mx/images/92931515066045884.jpg"" alt width=""600"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-bottom:10px;padding-left:40px;padding-right:40px;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:16px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:24px;color:#333333;"" id=""txconcepto""></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-content"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-content-body"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EDEDED;"" width=""600"" cellspacing=""0"" cellpadding=""0"" bgcolor=""#ededed"" align=""center"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""520"" align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><h3 style=""Margin:0;line-height:24px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:20px;font-style:normal;font-weight:normal;color:#333333;"">Evaluación de proveedor</h3></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Estimado usuario, el folio de la evalución No. " & folio.ToString() & ", ha sido dada de " & dt.Tables(0).Rows(0)("descripcionstatus") & ", deberá ingresar a SINGA para validar y/o cerrar la evaluación.<br></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-bottom:10px;padding-top:15px;""><h3 style=""Margin:0;line-height:24px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:20px;font-style:normal;font-weight:normal;color:#333333;"">Proveedor: " & dt.Tables(0).Rows(0)("nombre") & "</h3></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p20b"" width=""580"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-table-not-adapt"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)

        'Folio
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">No. Folio: " & folio & ".</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        'Fecha de Registro
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Fecha de registro: " & dt.Tables(0).Rows(0)("fecha_evaluacion") & ".</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        'PROMEDIO
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Promedio calificación: " & dt.Tables(0).Rows(0)("promedio") & ".</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        'TEXTO_PROMEDIO
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Resultado: " & dt.Tables(0).Rows(0)("texto_promedio") & ".</p></td>" & vbCrLf)

        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-content"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-content-body"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EDEDED;"" width=""600"" cellspacing=""0"" cellpadding=""0"" bgcolor=""#ededed"" align=""center"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img class=""adapt-img"" src=""http://grupobatia.com.mx/images/94931515066951223.png"" alt width=""600"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td style=""Margin:0;padding-top:10px;padding-bottom:20px;padding-left:20px;padding-right:20px;background-color:#34265F;"" bgcolor=""#34265f"" align=""left"">" & vbCrLf)
        sqlbr.Append("<!--[if mso]><table width=""560"" cellpadding=""0"" cellspacing=""0""><tr><td width=""194""><![endif]-->" & vbCrLf)
        sqlbr.Append("<table class=""es-left"" cellspacing=""0"" cellpadding=""0"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p0r es-m-p20b"" width=""174"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td esdev-links-color=""#ffffff"" align=""right"" style=""padding:0;Margin:0;padding-top:5px;""><h3 style=""Margin:0;line-height:48px;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:32px;font-style:normal;font-weight:normal;color:#FFFFFF;""><strong><a target=""_blank"" style=""-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:32px;text-decoration:none;color:#FFFFFF;line-height:48px;"" href=""https://viewstripo.email/"">SINGA</a></strong><br></h3></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("<td class=""es-hidden"" width=""20"" style=""padding:0;Margin:0;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-right"" cellspacing=""0"" cellpadding=""0"" align=""right"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p20b"" width=""173"" align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<!--[if mso]></td></tr></table><![endif]--></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-footer"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-footer-body"" width=""600"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:transparent;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;padding-top:20px;padding-left:20px;padding-right:20px;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""560"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img src=""http://grupobatia.com.mx/images/logo%20batia.png"" alt=""Logo Batia"" title=""Logo Batia"" width=""104"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:10px;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:12px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:18px;color:#333333;"">Usted esta recibiendo este correo de forma automática, favor de NO responder al remitente, si usted no es el destinatario correcto favor de hacer caso omiso del mismo.</p><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:12px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:18px;color:#333333;""><a target=""_blank"" href="""" style=""-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:12px;text-decoration:none;color:#34265F;"">quiero saber mas</a> | <a target=""_blank"" href=""http://singa.com.mx:8083/login.aspx"" style=""-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:12px;text-decoration:none;color:#34265F;"">sistema integral de gestión administrativa</a></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""Margin:0;padding-top:5px;padding-bottom:5px;padding-left:20px;padding-right:20px;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" height=""100%"" cellspacing=""0"" cellpadding=""0"" border=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td style=""padding:0;Margin:0px 0px 0px 0px;border-bottom:1px solid #CCCCCC;background:none;height:1px;width:100%;margin:0px;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:10px;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:12px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:18px;color:#333333;"">Grupo Batia, Av. Coyoacán 1704,&nbsp;Acacias 03100 Ciudad de México</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</div>" & vbCrLf)
        sqlbr.Append("</body>" & vbCrLf)
        sqlbr.Append("</html>" & vbCrLf)

        'enviaEvaluacioProv(sqlbr.ToString, destinos, folio)
        'envia(sqlbr.ToString, destinos, folio)
        Dim enviartodo As New enviacorreo()
        Dim notificacion As String = "NOTIFICACION DE SINGA, Solicitud de recursos No: " + folio.ToString
        enviartodo.envia(sqlbr.ToString, destinos, notificacion)

        Return ""
    End Function
    Protected Function enviaEvaluacioProv(ByVal cuerpo As String, ByVal destino As String, ByVal folio As Integer) As String

        Dim mail As New MailMessage
        mail.From = New MailAddress("adminsinga@grupobatia.com.mx")

        Dim v_par As Array
        v_par = (destino).Split(";")
        For i As Integer = 0 To v_par.Length - 1
            If v_par(i) <> "" Then mail.To.Add("" & v_par(i) & "")
        Next

        Dim asunto As String = "NOTIFICACION DE SINGA"
        'mail.To.Add()
        If folio <> 0 Then
            asunto += ",  Evaluación de proveedor No: " + folio.ToString
        End If
        mail.Subject = asunto
        mail.IsBodyHtml = True
        mail.Body = cuerpo

        Dim pass As String = "Ad*Gb1001"
        Dim mailClient As New SmtpClient()
        Dim basicAuthenticationInfo As New NetworkCredential("adminsinga@grupobatia.com.mx", "" & pass & "")
        mailClient.Host = "smtp.office365.com"
        mailClient.UseDefaultCredentials = True
        mailClient.Credentials = basicAuthenticationInfo
        mailClient.Port = 587
        mailClient.EnableSsl = True

        Try
            mailClient.Send(mail)

        Catch ex As Exception

        End Try

        Return ""

    End Function
    Public Function requisicion(ByVal folio As Integer) As String
        Dim sqlbr As New StringBuilder

        Dim myConnection As New SqlConnection((New Conexion).StrConexion)
        Dim destinos = ""
        'Dim destinos = "ricardob@grupobatia.com.mx;"

        Dim sql As String = ""
        sql = "select b.correo + ';' + c.per_email as correos, d.nombre as empresa, convert(varchar(12), a.falta, 103) as falta, e.nombre as cliente,"
        sql += "case when a.tipo = 1 then 'Entrega mensual' else 'Solicitado por el cliente' end as tipo from tb_requisicion a inner join tb_empleado b on a.id_comprador = b.id_empleado"
        sql += " inner join personal c on a.ualta = c.IdPersonal inner join tb_empresa d on a.id_empresa = d.id_empresa"
        sql += " left outer join tb_cliente e on a.id_cliente = e.id_cliente"
        sql += " where id_requisicion = " & folio & ";"
        Dim da As New SqlDataAdapter(sql, myConnection)
        Dim dt As New DataSet
        da.Fill(dt)
        If dt.Tables(0).Rows.Count > 0 Then
            destinos += dt.Tables(0).Rows(0)("correos")
        End If
        sqlbr.Append("<html style=""width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<head>" & vbCrLf)
        sqlbr.Append("<meta charset=""UTF-8"">" & vbCrLf)
        sqlbr.Append("<meta content=""width=device-width, initial-scale=1"" name=""viewport"">" & vbCrLf)
        sqlbr.Append("<meta name=""x-apple-disable-message-reformatting"">" & vbCrLf)
        sqlbr.Append("<meta http-equiv=""X-UA-Compatible"" content=""IE=edge"">" & vbCrLf)
        sqlbr.Append("<meta content=""telephone=no"" name=""format-detection"">" & vbCrLf)
        sqlbr.Append("<title>Nuevo correo electrónico 2</title>" & vbCrLf)
        sqlbr.Append("<!--[if (mso 16)]>" & vbCrLf)
        sqlbr.Append("<style type=""text/css"">" & vbCrLf)
        sqlbr.Append("a {text-decoration: none;}" & vbCrLf)
        sqlbr.Append("</style>" & vbCrLf)
        sqlbr.Append("<![endif]-->" & vbCrLf)
        sqlbr.Append("<!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]-->" & vbCrLf)
        sqlbr.Append("<!--[if !mso]><!-- -->" & vbCrLf)
        sqlbr.Append("<link href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,700,700i"" rel=""stylesheet"">" & vbCrLf)
        sqlbr.Append("<!--<![endif]-->" & vbCrLf)
        sqlbr.Append("<style type=""text/css"">" & vbCrLf)
        sqlbr.Append("@media only screen and (max-width:600px) {p, ul li, ol li, a { font-size:16px!important; line-height:150%!important } h1 { font-size:30px!important; text-align:center; line-height:120%!important } h2 { font-size:26px!important; text-align:center; line-hei" & vbCrLf)
        sqlbr.Append("#outlook a {" & vbCrLf)
        sqlbr.Append("	padding: 0;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".ExternalClass {" & vbCrLf)
        sqlbr.Append("	width: 100%;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".ExternalClass," & vbCrLf)
        sqlbr.Append(".ExternalClass p," & vbCrLf)
        sqlbr.Append(".ExternalClass span," & vbCrLf)
        sqlbr.Append(".ExternalClass font," & vbCrLf)
        sqlbr.Append(".ExternalClass td," & vbCrLf)
        sqlbr.Append(".ExternalClass div {" & vbCrLf)
        sqlbr.Append("	line-height:  100%;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".es-button {" & vbCrLf)
        sqlbr.Append("	mso-style-priority:100!important;" & vbCrLf)
        sqlbr.Append("	text-decoration: none!important;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append("a[x-apple-data-detectors] {" & vbCrLf)
        sqlbr.Append("	color:inherit!important;" & vbCrLf)
        sqlbr.Append("	text-decoration: none!important;" & vbCrLf)
        sqlbr.Append("	font-size:inherit!important;" & vbCrLf)
        sqlbr.Append("	font-family: inherit!important;" & vbCrLf)
        sqlbr.Append("	font-weight:inherit!important;" & vbCrLf)
        sqlbr.Append("	line-height: inherit!important;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".es-desk-hidden {" & vbCrLf)
        sqlbr.Append("	display:none;" & vbCrLf)
        sqlbr.Append("	float: Left;" & vbCrLf)
        sqlbr.Append("	overflow:hidden;" & vbCrLf)
        sqlbr.Append("	width:  0;" & vbCrLf)
        sqlbr.Append("	max-height:0;" & vbCrLf)
        sqlbr.Append("	line-height:  0;" & vbCrLf)
        sqlbr.Append("	mso-hide: all;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append("</style>" & vbCrLf)
        sqlbr.Append("</head>" & vbCrLf)
        sqlbr.Append("<body style=""width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<div class=""es-wrapper-color"" style=""background-color:#E4E5E7;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-header"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-header-body"" width=""600"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#34265F;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;padding-top:20px;padding-left:20px;padding-right:20px;"">" & vbCrLf)
        sqlbr.Append("<!--[if mso]><table width=""560"" cellpadding=""0"" cellspacing=""0""><tr><td width=""178"" valign=""top""><![endif]-->" & vbCrLf)
        sqlbr.Append("<table class=""es-left"" cellspacing=""0"" cellpadding=""0"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p0r es-m-p20b"" width=""178"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-txt-c"" align=""left"" style=""padding:0;Margin:0;""><img src=""http://grupobatia.com.mx/images/gbblanco.png"" alt=""Logo Batia"" title=""Logo Batia"" width=""104"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<!--[if mso]></td><td width=""20""></td><td width=""362"" valign=""top""><![endif]-->" & vbCrLf)
        sqlbr.Append("<table cellspacing=""0"" cellpadding=""0"" align=""right"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""362"" align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-txt-c"" align=""right"" style=""padding:0;Margin:0;padding-top:15px;padding-bottom:20px;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;"">Fecha:  " & dt.Tables(0).Rows(0)("falta") & "</p><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;"" id=""txfechaenvio""></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<!--[if mso]></td></tr></table><![endif]--></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img class=""adapt-img"" src=""http://grupobatia.com.mx/images/47051523540803179.png"" alt style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" width=""600""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-content"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-content-body"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EDEDED;"" width=""600"" cellspacing=""0"" cellpadding=""0"" bgcolor=""#ededed"" align=""center"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-top:20px;padding-left:40px;padding-right:40px;""><h1 style=""Margin:0;line-height:36px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:30px;font-style:normal;font-weight:normal;color:#333333;"">Mensaje generado por SINGA</h1></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img class=""adapt-img"" src=""http://grupobatia.com.mx/images/92931515066045884.jpg"" alt width=""600"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-bottom:10px;padding-left:40px;padding-right:40px;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:16px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:24px;color:#333333;"" id=""txconcepto""></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-content"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-content-body"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EDEDED;"" width=""600"" cellspacing=""0"" cellpadding=""0"" bgcolor=""#ededed"" align=""center"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""520"" align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><h3 style=""Margin:0;line-height:24px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:20px;font-style:normal;font-weight:normal;color:#333333;"">Requisiciòn de compra</h3></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Estimado usuario, se ha registrado una Requisición de compra, le agradecemos ingresar a SINGA para validar y en su caso autorizar la requisición, a continuación un resumen de los datos.<br></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-bottom:10px;padding-top:15px;""><h3 style=""Margin:0;line-height:24px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:20px;font-style:normal;font-weight:normal;color:#333333;"">Cliente: " & dt.Tables(0).Rows(0)("cliente") & "</h3></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p20b"" width=""580"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-table-not-adapt"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">No. Requisición: " & folio & ".</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Tipo: " & dt.Tables(0).Rows(0)("tipo") & ".</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Empresa: " & dt.Tables(0).Rows(0)("empresa") & ".</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Fecha de registro: " & dt.Tables(0).Rows(0)("falta") & ".</p></td>" & vbCrLf)

        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        'sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        'sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        'sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        'sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        'sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        'sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Incidencia/Especialidad: " & dt.Tables(0).Rows(0)("Tk_Inc_Descripcion") & ".</p></td>" & vbCrLf)
        'sqlbr.Append("</tr>" & vbCrLf)
        'sqlbr.Append("</table>" & vbCrLf)
        'sqlbr.Append("</td>" & vbCrLf)
        'sqlbr.Append("</tr>" & vbCrLf)



        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-content"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-content-body"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EDEDED;"" width=""600"" cellspacing=""0"" cellpadding=""0"" bgcolor=""#ededed"" align=""center"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img class=""adapt-img"" src=""http://grupobatia.com.mx/images/94931515066951223.png"" alt width=""600"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td style=""Margin:0;padding-top:10px;padding-bottom:20px;padding-left:20px;padding-right:20px;background-color:#34265F;"" bgcolor=""#34265f"" align=""left"">" & vbCrLf)
        sqlbr.Append("<!--[if mso]><table width=""560"" cellpadding=""0"" cellspacing=""0""><tr><td width=""194""><![endif]-->" & vbCrLf)
        sqlbr.Append("<table class=""es-left"" cellspacing=""0"" cellpadding=""0"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p0r es-m-p20b"" width=""174"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td esdev-links-color=""#ffffff"" align=""right"" style=""padding:0;Margin:0;padding-top:5px;""><h3 style=""Margin:0;line-height:48px;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:32px;font-style:normal;font-weight:normal;color:#FFFFFF;""><strong><a target=""_blank"" style=""-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:32px;text-decoration:none;color:#FFFFFF;line-height:48px;"" href=""https://viewstripo.email/"">SINGA</a></strong><br></h3></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("<td class=""es-hidden"" width=""20"" style=""padding:0;Margin:0;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-right"" cellspacing=""0"" cellpadding=""0"" align=""right"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p20b"" width=""173"" align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<!--[if mso]></td></tr></table><![endif]--></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-footer"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-footer-body"" width=""600"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:transparent;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;padding-top:20px;padding-left:20px;padding-right:20px;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""560"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img src=""http://grupobatia.com.mx/images/logo%20batia.png"" alt=""Logo Batia"" title=""Logo Batia"" width=""104"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:10px;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:12px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:18px;color:#333333;"">Usted esta recibiendo este correo de forma automática, favor de NO responder al remitente, si usted no es el destinatario correcto favor de hacer caso omiso del mismo.</p><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:12px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:18px;color:#333333;""><a target=""_blank"" href="""" style=""-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:12px;text-decoration:none;color:#34265F;"">quiero saber mas</a> | <a target=""_blank"" href=""http://singa.com.mx:8083/login.aspx"" style=""-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:12px;text-decoration:none;color:#34265F;"">sistema integral de gestión administrativa</a></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""Margin:0;padding-top:5px;padding-bottom:5px;padding-left:20px;padding-right:20px;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" height=""100%"" cellspacing=""0"" cellpadding=""0"" border=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td style=""padding:0;Margin:0px 0px 0px 0px;border-bottom:1px solid #CCCCCC;background:none;height:1px;width:100%;margin:0px;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:10px;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:12px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:18px;color:#333333;"">Grupo Batia, Av. Coyoacán 1704,&nbsp;Acacias 03100 Ciudad de México</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</div>" & vbCrLf)
        sqlbr.Append("</body>" & vbCrLf)
        sqlbr.Append("</html>" & vbCrLf)

        envia(sqlbr.ToString, destinos, folio)

        Return ""
    End Function

    Public Function requisicionauto(ByVal folio As Integer) As String
        Dim sqlbr As New StringBuilder

        Dim myConnection As New SqlConnection((New Conexion).StrConexion)
        Dim destinos = ""
        'Dim destinos = "ricardob@grupobatia.com.mx;"

        Dim sql As String = ""
        sql = "select b.correo + ';' + c.per_email as correos, d.nombre as empresa, convert(varchar(12), a.falta, 103) as falta, e.nombre as cliente,"
        sql += "case when a.tipo = 1 then 'Entrega mensual' else 'Solicitado por el cliente' end as tipo, "
        sql += "case when a.id_status = 2 then 'Autorizada' when a.id_status = 3 then 'Rechazada' end as estatus"
        sql += " from tb_requisicion a inner join tb_empleado b on a.id_comprador = b.id_empleado "
        sql += " inner join personal c on a.ualta = c.IdPersonal inner join tb_empresa d on a.id_empresa = d.id_empresa"
        sql += " left outer join tb_cliente e on a.id_cliente = e.id_cliente"
        sql += " where id_requisicion = " & folio & ";"
        Dim da As New SqlDataAdapter(sql, myConnection)
        Dim dt As New DataSet
        da.Fill(dt)
        If dt.Tables(0).Rows.Count > 0 Then
            destinos += dt.Tables(0).Rows(0)("correos")
        End If
        sqlbr.Append("<html style=""width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<head>" & vbCrLf)
        sqlbr.Append("<meta charset=""UTF-8"">" & vbCrLf)
        sqlbr.Append("<meta content=""width=device-width, initial-scale=1"" name=""viewport"">" & vbCrLf)
        sqlbr.Append("<meta name=""x-apple-disable-message-reformatting"">" & vbCrLf)
        sqlbr.Append("<meta http-equiv=""X-UA-Compatible"" content=""IE=edge"">" & vbCrLf)
        sqlbr.Append("<meta content=""telephone=no"" name=""format-detection"">" & vbCrLf)
        sqlbr.Append("<title>Nuevo correo electrónico 2</title>" & vbCrLf)
        sqlbr.Append("<!--[if (mso 16)]>" & vbCrLf)
        sqlbr.Append("<style type=""text/css"">" & vbCrLf)
        sqlbr.Append("a {text-decoration: none;}" & vbCrLf)
        sqlbr.Append("</style>" & vbCrLf)
        sqlbr.Append("<![endif]-->" & vbCrLf)
        sqlbr.Append("<!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]-->" & vbCrLf)
        sqlbr.Append("<!--[if !mso]><!-- -->" & vbCrLf)
        sqlbr.Append("<link href=""https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,700,700i"" rel=""stylesheet"">" & vbCrLf)
        sqlbr.Append("<!--<![endif]-->" & vbCrLf)
        sqlbr.Append("<style type=""text/css"">" & vbCrLf)
        sqlbr.Append("@media only screen and (max-width:600px) {p, ul li, ol li, a { font-size:16px!important; line-height:150%!important } h1 { font-size:30px!important; text-align:center; line-height:120%!important } h2 { font-size:26px!important; text-align:center; line-hei" & vbCrLf)
        sqlbr.Append("#outlook a {" & vbCrLf)
        sqlbr.Append("	padding: 0;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".ExternalClass {" & vbCrLf)
        sqlbr.Append("	width: 100%;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".ExternalClass," & vbCrLf)
        sqlbr.Append(".ExternalClass p," & vbCrLf)
        sqlbr.Append(".ExternalClass span," & vbCrLf)
        sqlbr.Append(".ExternalClass font," & vbCrLf)
        sqlbr.Append(".ExternalClass td," & vbCrLf)
        sqlbr.Append(".ExternalClass div {" & vbCrLf)
        sqlbr.Append("	line-height:  100%;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".es-button {" & vbCrLf)
        sqlbr.Append("	mso-style-priority:100!important;" & vbCrLf)
        sqlbr.Append("	text-decoration: none!important;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append("a[x-apple-data-detectors] {" & vbCrLf)
        sqlbr.Append("	color:inherit!important;" & vbCrLf)
        sqlbr.Append("	text-decoration: none!important;" & vbCrLf)
        sqlbr.Append("	font-size:inherit!important;" & vbCrLf)
        sqlbr.Append("	font-family: inherit!important;" & vbCrLf)
        sqlbr.Append("	font-weight:inherit!important;" & vbCrLf)
        sqlbr.Append("	line-height: inherit!important;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append(".es-desk-hidden {" & vbCrLf)
        sqlbr.Append("	display:none;" & vbCrLf)
        sqlbr.Append("	float: Left;" & vbCrLf)
        sqlbr.Append("	overflow:hidden;" & vbCrLf)
        sqlbr.Append("	width:  0;" & vbCrLf)
        sqlbr.Append("	max-height:0;" & vbCrLf)
        sqlbr.Append("	line-height:  0;" & vbCrLf)
        sqlbr.Append("	mso-hide: all;" & vbCrLf)
        sqlbr.Append("}" & vbCrLf)
        sqlbr.Append("</style>" & vbCrLf)
        sqlbr.Append("</head>" & vbCrLf)
        sqlbr.Append("<body style=""width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<div class=""es-wrapper-color"" style=""background-color:#E4E5E7;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-header"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-header-body"" width=""600"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#34265F;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;padding-top:20px;padding-left:20px;padding-right:20px;"">" & vbCrLf)
        sqlbr.Append("<!--[if mso]><table width=""560"" cellpadding=""0"" cellspacing=""0""><tr><td width=""178"" valign=""top""><![endif]-->" & vbCrLf)
        sqlbr.Append("<table class=""es-left"" cellspacing=""0"" cellpadding=""0"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p0r es-m-p20b"" width=""178"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-txt-c"" align=""left"" style=""padding:0;Margin:0;""><img src=""http://grupobatia.com.mx/images/gbblanco.png"" alt=""Logo Batia"" title=""Logo Batia"" width=""104"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<!--[if mso]></td><td width=""20""></td><td width=""362"" valign=""top""><![endif]-->" & vbCrLf)
        sqlbr.Append("<table cellspacing=""0"" cellpadding=""0"" align=""right"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""362"" align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-txt-c"" align=""right"" style=""padding:0;Margin:0;padding-top:15px;padding-bottom:20px;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;"">Fecha:  " & dt.Tables(0).Rows(0)("falta") & "</p><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#FFFFFF;"" id=""txfechaenvio""></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<!--[if mso]></td></tr></table><![endif]--></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img class=""adapt-img"" src=""http://grupobatia.com.mx/images/47051523540803179.png"" alt style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" width=""600""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-content"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-content-body"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EDEDED;"" width=""600"" cellspacing=""0"" cellpadding=""0"" bgcolor=""#ededed"" align=""center"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-top:20px;padding-left:40px;padding-right:40px;""><h1 style=""Margin:0;line-height:36px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:30px;font-style:normal;font-weight:normal;color:#333333;"">Mensaje generado por SINGA</h1></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img class=""adapt-img"" src=""http://grupobatia.com.mx/images/92931515066045884.jpg"" alt width=""600"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-bottom:10px;padding-left:40px;padding-right:40px;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:16px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:24px;color:#333333;"" id=""txconcepto""></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-content"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-content-body"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EDEDED;"" width=""600"" cellspacing=""0"" cellpadding=""0"" bgcolor=""#ededed"" align=""center"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""Margin:0;padding-top:20px;padding-bottom:20px;padding-left:40px;padding-right:40px;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""520"" align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><h3 style=""Margin:0;line-height:24px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:20px;font-style:normal;font-weight:normal;color:#333333;"">Requisiciòn de compra</h3></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Estimado usuario, la Requsición No. " & folio.ToString() & ", ha sido " & dt.Tables(0).Rows(0)("estatus") & ", deberá ingresar a SINGA para validar o continuar su proceso de compra.<br></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;padding-bottom:10px;padding-top:15px;""><h3 style=""Margin:0;line-height:24px;mso-line-height-rule:exactly;font-family:tahoma, verdana, segoe, sans-serif;font-size:20px;font-style:normal;font-weight:normal;color:#333333;"">Cliente: " & dt.Tables(0).Rows(0)("cliente") & "</h3></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p20b"" width=""580"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-table-not-adapt"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">No. Requisición: " & folio & ".</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Tipo: " & dt.Tables(0).Rows(0)("tipo") & ".</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Empresa: " & dt.Tables(0).Rows(0)("empresa") & ".</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Fecha de registro: " & dt.Tables(0).Rows(0)("falta") & ".</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)

        'sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        'sqlbr.Append("<td valign=""top"" align=""left"" style=""padding:0;Margin:0;padding-top:10px;padding-bottom:10px;padding-right:10px;""><img src=""http://grupobatia.com.mx/images/Check_Mark_Black5.png"" alt=alt width=""16"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;"" /></td>" & vbCrLf)
        'sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        'sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        'sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        'sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:14px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;"">Incidencia/Especialidad: " & dt.Tables(0).Rows(0)("Tk_Inc_Descripcion") & ".</p></td>" & vbCrLf)
        'sqlbr.Append("</tr>" & vbCrLf)
        'sqlbr.Append("</table>" & vbCrLf)
        'sqlbr.Append("</td>" & vbCrLf)
        'sqlbr.Append("</tr>" & vbCrLf)



        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-content"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-content-body"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#EDEDED;"" width=""600"" cellspacing=""0"" cellpadding=""0"" bgcolor=""#ededed"" align=""center"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""600"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img class=""adapt-img"" src=""http://grupobatia.com.mx/images/94931515066951223.png"" alt width=""600"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td style=""Margin:0;padding-top:10px;padding-bottom:20px;padding-left:20px;padding-right:20px;background-color:#34265F;"" bgcolor=""#34265f"" align=""left"">" & vbCrLf)
        sqlbr.Append("<!--[if mso]><table width=""560"" cellpadding=""0"" cellspacing=""0""><tr><td width=""194""><![endif]-->" & vbCrLf)
        sqlbr.Append("<table class=""es-left"" cellspacing=""0"" cellpadding=""0"" align=""left"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p0r es-m-p20b"" width=""174"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td esdev-links-color=""#ffffff"" align=""right"" style=""padding:0;Margin:0;padding-top:5px;""><h3 style=""Margin:0;line-height:48px;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:32px;font-style:normal;font-weight:normal;color:#FFFFFF;""><strong><a target=""_blank"" style=""-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:32px;text-decoration:none;color:#FFFFFF;line-height:48px;"" href=""https://viewstripo.email/"">SINGA</a></strong><br></h3></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("<td class=""es-hidden"" width=""20"" style=""padding:0;Margin:0;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-right"" cellspacing=""0"" cellpadding=""0"" align=""right"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td class=""es-m-p20b"" width=""173"" align=""left"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<!--[if mso]></td></tr></table><![endif]--></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("<table class=""es-footer"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table class=""es-footer-body"" width=""600"" cellspacing=""0"" cellpadding=""0"" align=""center"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:transparent;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""left"" style=""padding:0;Margin:0;padding-top:20px;padding-left:20px;padding-right:20px;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td width=""560"" valign=""top"" align=""center"" style=""padding:0;Margin:0;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" cellspacing=""0"" cellpadding=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:0;Margin:0;""><img src=""http://grupobatia.com.mx/images/logo%20batia.png"" alt=""Logo Batia"" title=""Logo Batia"" width=""104"" style=""display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:10px;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:12px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:18px;color:#333333;"">Usted esta recibiendo este correo de forma automática, favor de NO responder al remitente, si usted no es el destinatario correcto favor de hacer caso omiso del mismo.</p><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:12px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:18px;color:#333333;""><a target=""_blank"" href="""" style=""-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:12px;text-decoration:none;color:#34265F;"">quiero saber mas</a> | <a target=""_blank"" href=""http://singa.com.mx:8083/login.aspx"" style=""-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;font-size:12px;text-decoration:none;color:#34265F;"">sistema integral de gestión administrativa</a></p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""Margin:0;padding-top:5px;padding-bottom:5px;padding-left:20px;padding-right:20px;"">" & vbCrLf)
        sqlbr.Append("<table width=""100%"" height=""100%"" cellspacing=""0"" cellpadding=""0"" border=""0"" style=""mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;"">" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td style=""padding:0;Margin:0px 0px 0px 0px;border-bottom:1px solid #CCCCCC;background:none;height:1px;width:100%;margin:0px;""></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("<tr style=""border-collapse:collapse;"">" & vbCrLf)
        sqlbr.Append("<td align=""center"" style=""padding:10px;Margin:0;""><p style=""Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-size:12px;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:18px;color:#333333;"">Grupo Batia, Av. Coyoacán 1704,&nbsp;Acacias 03100 Ciudad de México</p></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table></td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</td>" & vbCrLf)
        sqlbr.Append("</tr>" & vbCrLf)
        sqlbr.Append("</table>" & vbCrLf)
        sqlbr.Append("</div>" & vbCrLf)
        sqlbr.Append("</body>" & vbCrLf)
        sqlbr.Append("</html>" & vbCrLf)

        envia(sqlbr.ToString, destinos, folio)

        Return ""
    End Function
    'Protected Function envia(ByVal cuerpo As String, ByVal destino As String, ByVal folio As Integer) As String
    Protected Function envia(ByVal cuerpo As String, ByVal destino As String, ByVal folio As String) As String
        Dim mail As New MailMessage
        mail.From = New MailAddress("adminsinga@grupobatia.com.mx")

        Dim v_par As Array
        v_par = (destino).Split(";")
        For i As Integer = 0 To v_par.Length - 1
            If v_par(i) <> "" Then mail.To.Add("" & v_par(i) & "")
        Next

        Dim asunto As String = "NOTIFICACION DE SINGA"
        'mail.To.Add()
        If folio <> 0 Then
            asunto += ",  Requisición de compra No: " + folio.ToString
        End If
        mail.Subject = asunto
        mail.IsBodyHtml = True
        mail.Body = cuerpo

        Dim pass As String = "Ad*Gb1001"
        Dim mailClient As New SmtpClient()
        Dim basicAuthenticationInfo As New NetworkCredential("adminsinga@grupobatia.com.mx", "" & pass & "")
        mailClient.Host = "smtp.office365.com"
        mailClient.UseDefaultCredentials = True
        mailClient.Credentials = basicAuthenticationInfo
        mailClient.Port = 587
        mailClient.EnableSsl = True

        Try
            mailClient.Send(mail)

        Catch ex As Exception

        End Try

        Return ""

    End Function
End Class
